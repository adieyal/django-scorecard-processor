{% extends 'base.html' %}
{% block head_title %}Report results - {{object.name}}{% endblock %}
{% block script_bottom %}
{{block.super}}
<script type="text/javascript">
  $('[rel=popover]').popover();
</script>
{% endblock %}
{% block fluid_content_outer %}
  <style>
    caption {font-size:large;text-align:left;margin:10px 0}
  </style>
  <div class="fluid-container">
    <div class="content">
      <div class="page-header">
        <h1><a href="{{object.get_absolute_url}}">{{object.name}}</a> results <small>from <a href="{{object.scorecard.project.get_absolute_url}}">{{object.scorecard.project.name}}</a></small></h1>
      </div>
          <h2>Report output</h2>
          {% for key, result in report.items %}
            {% with result.get_values as inner_result %}
              {% if inner_result %}
                <table style="width:auto" class="bordered-table zebra-striped condensed-table">
                <caption>{{key.name}}</caption>
                {% for item in inner_result %}
                  {% if forloop.counter0 == 0 %}
                    <tr>
                      <tr>
                        <th rowspan=2 style="vertical-align:bottom">{% if item.0.data_type %}{{item.0.data_type}}{% else %}{% for k in item.0 %}{{k.data_type}}{% if forloop.revcounter0 %}, {% endif %}{% endfor %}{% endif %}</th>
                        {% for k, v in item.1 %}
                            <th title="{{k.description}}" colspan="{{v|length}}" style="text-align:center">{{k.identifier}}</th>
                        {% endfor %}
                      </tr>
                      <tr>
                        {% if item.1.0.1.0.0 != None %}
                            {% for k, v in item.1 %}
                              {% for ds, value in v %}
                                <th>{{ds.name}}</th>
                              {% endfor %}
                            {% endfor %}
                        {% endif %}
                      </tr>
                    </tr>
                  {% endif %}
                  <tr>
                  <th>{{item.0.name}}</th>
                  {% for i, items in item.1 %}
                        {% for series, v in items %}
                          <td>{% if v %}{{v}}{% endif %}</td>
                        {% endfor %}
                  {% endfor %}
                  </tr>
                {% endfor %}
                </table>

              {% else %}
                {% if forloop.counter0 == 0 %}
                  <table style="width:auto" class="bordered-table zebra-striped condensed-table">
                    <thead>
                      <tr>
                        <th rowspan=2 valign=bottom>{% if key.data_type %}{{key.data_type}}{% else %}{% for k in key %}{{k.data_type}}{% if forloop.revcounter0 %}, {% endif %}{% endfor %}{% endif %}</th>
                        {% for k, v in result %}
                            <th title="{{k.description}}" colspan="{{v|length}}" style="text-align:center">{{k.identifier}}</th>
                        {% endfor %}
                      </tr>
                      <tr>
                        {% if result.0.1.0.0 != None %}
                            {% for k, v in result %}
                              {% for ds, value in v %}
                                <th>{{ds.name}}</th>
                              {% endfor %}
                            {% endfor %}
                        {% endif %}
                      </tr>
                    </thead>
                    <tbody>
                {% endif %}
                <tr>
                  <th>{{key.name}}</th>
                  {% for i, items in result %}
                        {% for series, v in items %}
                          <td>{% if v %}{{v}}{% endif %}</td>
                        {% endfor %}
                  {% endfor %}
                </tr>
                {% if forloop.last %}
                  </tbody>
                  </table>
                {% endif %}
              {% endif %}
            {% endwith %}
          {% endfor %}
          </table>
    </div>
  </div>
{% endblock %}
